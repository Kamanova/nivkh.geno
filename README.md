
Данный репозиторий преставляет собой описание методов исследования при выполнении дипломной работы.
Для формирования генеральной совокупности, биоинформатического и статистического анализа используются, как авторские программы, так и алгоритмы сотрудников лаборатории. Скрипты, написанные Дрёмовым С.В. лежат в [репозитоиии](https://gitlab.com/stasundr/nivkhi-geno-17) и в настоящая работа содержит лишь ссылки на них.

### Исходные данныe ###

В лаборатории были получены данные о генотипировании  48 образцов ДНК (челканцы, кумандинцы, нивхи, тоджинцы, телеуты,орок) на ДНК-микрочипах Illumina Infinium OmniExpress-24 v1-2 (по 713,599 SNP на образец). Перечисленые выше образцы вошли в состав исходного датасета, которые вдальнейшем объединяли с данными из другх статей, в которых использовались чипы illumina.

Для получения итогового датасета с максимально возможным пересечением по SNP выбирались статьй, содержащие данные о генотипировании на чипах фирмы illumina.

#### Источники генетических данных, для формирования генеральной совокупности: ####
1. Даные лаборатории (Illumina Infium OmniExpress)
2. Cardona et al., 2014 (Illumina Human OmniExpress)
3. Fedorova et al., 2013 (Illumina 660K)
4. Pakendorf et al., 2016 (Illumina 660W-Quad)
5. Rasmussen et al., 2010 (Illumina 660K/610K)
6. Li et al., 2008 (Illumina 650K)

Для формирования генеральной совокупности необходмо вычислить пересечение по SNP между всеми перечисленными датасетами, перевести их в eigenstrat-фомат и объединить.

Пересечение доступных чипов по количеству SNP определяли при помощи [JavaScript-скрипта](https://gitlab.com/stasundr/nivkhi-geno-17/blob/master/js/manifest_intersection.js),  анализируя манифест-файлы Illumina 


Совокупная выборка формировалась при помощи самописных скриптов. Результаты генотипирования образов нашей лаборатории были представленны 48 файлами, в каждом из которых первые 11 строк заголовок. Затем следует таблица, в которой содержатся данные о состоянии каждого из 713,599 SNP (SNP, Name, Sample ID, Allele1 - Top, Allele2 - Top, Allele1 - AB, Allele2 - AB).


[Скрипт](https://gitlab.com/stasundr/nivkhi-geno-17/blob/master/js/manifest_intersection.js/js/combine_omni.js) формирует geno-файл eigenstrat-формате. Для каждого файла первые 11 строк с заголовком игнорируются. Далее каждому SNP
вместо генотипа в виде A A, A B, B B или - ставится 0, 1, 2 или 9 соответственно (информация о rs номере, номере образца и нуклеотидном
состоянии игнорируется).

[Скрипт](https://gitlab.com/stasundr/nivkhi-geno-17/blob/master/js/manifest_intersection.js/js/manifest_snp.js) формирует snp-файл в eigenstrat-формате на основе манифест-файла и файла с координатами SNP ДНК-микрочипа Illumina.

ind-файл для выборки формировался вручную и включает три колонки: название образца, пол и название популяции.
