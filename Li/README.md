
Образцы из статьи Li, 2008 были генотипированы на чипах Illumina 650K (сейчас выпустили новую версию чипов, поэтому мы используем информацию для Illumina Human610K)

Инструкция по обработке даных генотипирования и все сопутствующие этому скрипты можно найти по [ссылке](https://gitlab.com/stasundr/nivkhi-geno-17/blob/master/Li2008.md)

### Попытка добавть результаты генотипирования в датасет самостоятельн о###

Генетические данные  публикованные в статье [Li, 2008](http://hagsc.org/hgdp/files.html) скачивались на кластер. Сжатый файл содержал в себе три документа: HGDP_Map.txt (информация об SNP), HGDP_SampleList.txt (перечисленные образцы), HGDP_FinalReport_Forward.txt (таблица с генотипами образцов). 

Данные с HGDP включают результаты генотипирования аутосом, половых хромосом и митохондриальной ДНК. Пересечение по ОНП между HGDP_FinalReport_Forward.txt и списком ОНП для чипов Human610 (334501 snp) составило 314130 онп.

Ранее, при добавлении в выборку генетических данных из статьи Rasmussen 2010, мы получили snp-файл на основе чипов Human610. Этот snp-файл мы использовали и при добавлении к генеральной совокупности результатов Li.

Необходимо убрать из Rasmussen.snp, строки не содержащиеся в файле HGDP_FinalReport_Forward.txt. А затем на основе полученного snp-файла фильтруем HGDP_FinalReport_Forward.txt. В итоге получаем snp- и geno-файлы с одинаковым набором онп, которые расположены в разном порядке в двух списках. 
С помощью скрипта change-snp-order-for-geno.js меняем порядок снипов в файле snp, используя geno-файл как пример. В итоге получаем готовый файл li.snp.

В HGDP_FinalReport_Forward.txt генотипы представлены в виде нуклеотидов. Для их перевода в численный формат анализировали [Human610-Quadv1_H.csv](http://www.well.ox.ac.uk/~wrayner/strand/). Файл представляет собой таблицу, где в колонках указаны RsID, IlmnStrand, SNP (200003,TОР,[T/C]). Tа цепь, которая со стороны начала нумерации нуклеотидов в хромосомах имеет 5’ конец называется TOP  (верхняя), а комплементарная ей –  BOTTOM (нижняя). Если указана цепь TOP, то мы понимаем, что нуклеотид Т является референсным и при наличие у образца генотипа TТ, мы переведем его в eigestrat-формат - АА. Если указана цепь ВОТ (200003,ВОТ,[T/C]) и генотип у образца ТТ, то мы переводим его в eigenstrat-формат как ВВ. Так как у нас уже есть готовый li.snp, мы знаем для каждого RsId какой нуклеотид заменялся на какой и с помощью скрипта li-to-geno.js создаем geno-файл.

Для создания ind- файла скачиваем [li-sample-information](http://math.stanford.edu/~yuany/course/data/ceph_hgdp_minor_code_XNA.sampleInformation.csv) и оставляем только необходимые колонки (li-to-ind.js). 
